"use strict";(self.webpackChunkscvi_tools_site=self.webpackChunkscvi_tools_site||[]).push([[8716],{3905:function(e,t,a){a.d(t,{Zo:function(){return p},kt:function(){return u}});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),m=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},p=function(e){var t=m(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,s=e.originalType,l=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),d=m(a),u=i,h=d["".concat(l,".").concat(u)]||d[u]||c[u]||s;return a?n.createElement(h,r(r({ref:t},p),{},{components:a})):n.createElement(h,r({ref:t},p))}));function u(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var s=a.length,r=new Array(s);r[0]=d;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var m=2;m<s;m++)r[m]=a[m];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},3919:function(e,t,a){function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function i(e){return void 0!==e&&!n(e)}a.d(t,{b:function(){return n},Z:function(){return i}})},4996:function(e,t,a){a.d(t,{C:function(){return s},Z:function(){return r}});var n=a(2263),i=a(3919);function s(){var e=(0,n.Z)().siteConfig,t=(e=void 0===e?{}:e).baseUrl,a=void 0===t?"/":t,s=e.url;return{withBaseUrl:function(e,t){return function(e,t,a,n){var s=void 0===n?{}:n,r=s.forcePrependBaseUrl,o=void 0!==r&&r,l=s.absolute,m=void 0!==l&&l;if(!a)return a;if(a.startsWith("#"))return a;if((0,i.b)(a))return a;if(o)return t+a;var p=a.startsWith(t)?a:t+a.replace(/^\//,"");return m?e+p:p}(s,a,e,t)}}}function r(e,t){return void 0===t&&(t={}),(0,s().withBaseUrl)(e,t)}},9842:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return l},contentTitle:function(){return m},metadata:function(){return p},assets:function(){return c},toc:function(){return d},default:function(){return h}});var n=a(7462),i=a(3366),s=(a(7294),a(3905)),r=a(4996),o=["components"],l={slug:"v13",title:"scvi-tools 1.3 release",date:new Date("2025-07-03T00:00:00.000Z"),author:"Ori Kronfeld",tags:["scvi-tools","release"]},m=void 0,p={permalink:"/blog/v13",editUrl:"https://github.com/YosefLab/scvi-tools-site/blog/blog/2025-3-7-scvi-tools-v1p3.md",source:"@site/blog/2025-3-7-scvi-tools-v1p3.md",title:"scvi-tools 1.3 release",description:"Introduction",date:"2025-07-03T00:00:00.000Z",formattedDate:"July 3, 2025",tags:[{label:"scvi-tools",permalink:"/blog/tags/scvi-tools"},{label:"release",permalink:"/blog/tags/release"}],readingTime:8.32,truncated:!1,authors:[{name:"Ori Kronfeld"}],nextItem:{title:"Mini-batch size in destVI",permalink:"/blog/destvi-batchsize"}},c={authorsImageUrls:[void 0]},d=[{value:"Introduction",id:"introduction",children:[]},{value:"1. \ud83d\udd2c New Models",id:"1--new-models",children:[{value:"ResolVI",id:"resolvi",children:[]},{value:"scVIVA",id:"scviva",children:[]},{value:"CytoVI",id:"cytovi",children:[]},{value:"VIVS",id:"vivs",children:[]},{value:"SysVI",id:"sysvi",children:[]},{value:"Decipher",id:"decipher",children:[]},{value:"MethylVI",id:"methylvi",children:[]},{value:"MethylANVI",id:"methylanvi",children:[]},{value:"totalANVI",id:"totalanvi",children:[]},{value:"mrVI in pyTorch",id:"mrvi-in-pytorch",children:[]}]},{value:"2. \ud83e\udde9 Custom Dataloaders",id:"2-\ud83e\udde9-custom-dataloaders",children:[{value:"LaminDB",id:"lamindb",children:[]},{value:"Census",id:"census",children:[]},{value:"AnnCollection",id:"anncollection",children:[]}]},{value:"3. \u2699\ufe0f Core Enhancements",id:"3-\ufe0f-core-enhancements",children:[{value:"Multi\u2011GPU Training",id:"multigpu-training",children:[]},{value:"scIB\u2011Metrics Optimization",id:"scibmetrics-optimization",children:[]},{value:"Explainability &amp; Interpretability",id:"explainability--interpretability",children:[]}]},{value:"Summary",id:"summary",children:[]},{value:"References",id:"references",children:[]}],u={toc:d};function h(e){var t=e.components,a=(0,i.Z)(e,o);return(0,s.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h2",{id:"introduction"},"Introduction"),(0,s.kt)("p",null,"We\u2019re proud to introduce scvi\u2011tools v1.3, encompassing major advances in modeling, data loading, computational scalability, metric integration, and interpretability in single-cell analytics. "),(0,s.kt)("p",null,"Featuring nine new or enhanced models, optimized for spatial, cytometry, methylation, perturbation, and multi\u2011omic data, it also introduces custom data loaders for large-scale datasets, multi\u2011GPU model training, on-the-fly metric tuning, and integrated model interpretability. "),(0,s.kt)("p",null,"This article delves into each enhancement with depth, including detailed insights, illustrative figures, and manuscript references."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"1--new-models"},"1. \ud83d\udd2c New Models"),(0,s.kt)("h3",{id:"resolvi"},"ResolVI"),(0,s.kt)("p",null,"ResolVI",(0,s.kt)("sup",{parentName:"p",id:"fnref-1"},(0,s.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," is a spatial transcriptomics denoising model that reallocates mis-assigned gene counts among true cells, neighborhood leakage, and background. It employs a Gaussian-mixture latent prior to learn corrected counts and interpretable embeddings. This approach is highly scalable (handling >1 million spots) and offers downstream capabilities like differential expression and transfer learning on corrected data"),(0,s.kt)("p",null,"In ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/spatial/resolVI_tutorial.html"},"tutorial"),", it has been shown to markedly enhance spatial expression accuracy in noisy segmentation settings, enabling reliable differential expression especially in high-throughput ST datasets.  "),(0,s.kt)("img",{alt:"ResolVI",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/resolvi.png")}),(0,s.kt)("p",null,"Figure 1: ResolVI cell type annotations based on noisy cellular segmentation Xenium data of a mouse brain. The left hemisphere for model training and the right hemisphere for transfer mapping. "),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"scviva"},"scVIVA"),(0,s.kt)("p",null,"scVIVA",(0,s.kt)("sup",{parentName:"p",id:"fnref-2"},(0,s.kt)("a",{parentName:"sup",href:"#fn-2",className:"footnote-ref"},"2"))," augments spatial transcriptomics analysis by jointly modeling each cell\u2019s own expression and its micro-environmental context (neighborhood composition and gene counts). This niche-aware VAE embeds both cellular identity and environmental features, revealing tissue-specific patterns and environment-driven variation. Its latent embeddings delineate tissue-specific structures - ideal for spatial differential abundance or niche-focused clustering studies."),(0,s.kt)("p",null,"Dedicated ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/spatial/scVIVA_tutorial.html"},"tutorial")," showcase how scVIVA enables niche-focused clustering and differential abundance analyses"),(0,s.kt)("img",{alt:"scVIVA",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/scviva.png")}),(0,s.kt)("p",null,"Figure 2: scVIVA results: median Log-Fold Change (LFC) of upregulated genes in ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"G1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\textit{G1}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"G1"))))))," vs ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"G2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\textit{G2}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"G2"))))))," displayed on the x-axis, while we compare differential expression computed between ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"N1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\textit{N1}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"N1")))))),"  and ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"G2")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\textit{G2}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"G2"))))))," on the y-axis.\nGenes are colored by their marker label (yellow=significantly upregulated in ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"G1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\textit{G1}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"G1"))))))," vs ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mtext",{parentName:"mrow",mathvariant:"italic"},"N1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\textit{N1}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.68333em",verticalAlign:"0em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord textit"},"N1")))))),", green otherwise).\nWe also display the classifier decision boundary (the predicted probability of being in the yellow class). "),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"cytovi"},"CytoVI"),(0,s.kt)("p",null,"CytoVI",(0,s.kt)("sup",{parentName:"p",id:"fnref-3"},(0,s.kt)("a",{parentName:"sup",href:"#fn-3",className:"footnote-ref"},"3"))," brings totalVI-inspired modeling to cytometry and mass cytometry data. It models protein-marker distributions, corrects for dropouts and technical batch variation, and generates embeddings for downstream clustering and abundance inference. "),(0,s.kt)("p",null,"Early ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/cytometry/CytoVI_tutorial.html"},"tutorial")," already demonstrate clear delineation of immune subpopulations across batch-affected datasets."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"vivs"},"VIVS"),(0,s.kt)("p",null,"Variational Inference for Variable Selection (VIVS",(0,s.kt)("sup",{parentName:"p",id:"fnref-4"},(0,s.kt)("a",{parentName:"sup",href:"#fn-4",className:"footnote-ref"},"4")),") identifies associations across modalities such as gene\u2013protein couplings\u2014while rigorously controlling false discovery rates using conditional randomization. VIVS achieves interpretable and scalable feature selection, enabling discovery of biologically meaningful links in paired datasets"),(0,s.kt)("p",null,"Tutorial in scvi-tools soon to be updated."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"sysvi"},"SysVI"),(0,s.kt)("p",null,"SysVI",(0,s.kt)("sup",{parentName:"p",id:"fnref-5"},(0,s.kt)("a",{parentName:"sup",href:"#fn-5",className:"footnote-ref"},"5"))," tackles major batch effects, such as those arising from cross-species or organoid-versus-tissue studies\u2014using latent cycle-consistency and VampPrior regularization. Compared to Harmony or regular scVI models, SysVI excels at aligning technical systems while preserving true biological variance, producing embedding spaces where analogous cell types across batches cluster coherently."),(0,s.kt)("p",null,"in the ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/scrna/sysVI.html"},"tutorial"),", we show the power of sysVI with data integration between human and mouse immune cells."),(0,s.kt)("img",{alt:"sysvi",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/sysvi.png")}),(0,s.kt)("p",null,"Figure 3: Example results of integration between human and mouse immune cells "),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"decipher"},"Decipher"),(0,s.kt)("p",null,"Decipher",(0,s.kt)("sup",{parentName:"p",id:"fnref-6"},(0,s.kt)("a",{parentName:"sup",href:"#fn-6",className:"footnote-ref"},"6"))," Designed to dissect perturbation effects (e.g., disease versus control), Decipher disentangles shared and condition-specific variation within a VAE framework. ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/scrna/decipher_tutorial.html"},"Demonstrated")," on AML (acute myeloid leukemia) data, it uncovers latent axes aligning with known disease signatures and identifies corresponding differentially expressed markers - bridging latent space analysis and functional biology."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"methylvi"},"MethylVI"),(0,s.kt)("p",null,"MethylVI",(0,s.kt)("sup",{parentName:"p",id:"fnref-7"},(0,s.kt)("a",{parentName:"sup",href:"#fn-7",className:"footnote-ref"},"7"))," is a VAE tailored for single-cell bisulfite sequencing (scBS\u2011seq). By modeling methylation probabilities at genomic regions, it captures epigenetic heterogeneity and learns latent spaces that integrate multiple batches. ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/scbs/MethylVI_batch.html"},"Tutorial")," show it outperforms linear methods like PCA in retaining biologically meaningful methylation structures."),(0,s.kt)("img",{alt:"methylvi",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/methylvi.png")}),(0,s.kt)("p",null,"Figure 4: MethylVI integration of cell types from different single-cell bi-sulfite sequencing platforms"),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"methylanvi"},"MethylANVI"),(0,s.kt)("p",null,"MethylANVI extends the MethylVI framework with annotation-aware modeling: it jointly integrates methylation profiles with metadata-driven cell-type labels. This supervised model supports both clustering and label transfer, all while capturing latent biological variation across methylome profiles, ideal for epigenetic atlas-building."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"totalanvi"},"totalANVI"),(0,s.kt)("p",null,"totalANVI brings supervised annotation to CITE\u2011seq-style multi-omic integration. Leveraging a VAE for RNA + protein, it jointly learns latent embeddings and cell-type classifiers. The model simultaneously performs dimensionality reduction, denoising, differential expression, and accurate cell-type annotation in one cohesive model."),(0,s.kt)("p",null,"Tutorial in scvi-tools soon to be updated."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"mrvi-in-pytorch"},"mrVI in pyTorch"),(0,s.kt)("p",null,"MrVI",(0,s.kt)("sup",{parentName:"p",id:"fnref-8"},(0,s.kt)("a",{parentName:"sup",href:"#fn-8",className:"footnote-ref"},"8"))," (Multi-resolution Variational Inference) is a model written in ",(0,s.kt)("a",{parentName:"p",href:"https://docs.jax.dev/en/latest/notebooks/thinking_in_jax.html"},"Jax")," for analyzing multi-sample, multi-batch single-cell RNA-seq data. MrVI is particularly suited for single-cell RNA sequencing datasets with comparable observations across many samples. It conducts both exploratory analyses (locally dividing samples into groups based on molecular properties) and comparative analyses (comparing pre-defined groups of samples in terms of differential expression and differential abundance) at single-cell resolution. "),(0,s.kt)("p",null,"In recent scvi-tools releases we added a Pytorch implementation of mrVI, to be along with the Jax one, to support broader options on how to use this popular model. "),(0,s.kt)("p",null,"Tutorial of mrVI in torch running on a subset of ",(0,s.kt)("a",{parentName:"p",href:"https://doi.org/10.1101/2025.02.20.639398"},"Tahoe100M")," cells dataset can be found ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/hub/Tahoe100_mrVI.html"},"here")),(0,s.kt)("img",{alt:"lamin",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/mrvi.png")}),(0,s.kt)("p",null,"Figure 5: mrVI Integration on Covid dataset"),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"2-\ud83e\udde9-custom-dataloaders"},"2. \ud83e\udde9 Custom Dataloaders"),(0,s.kt)("p",null,"scvi\u2011tools v1.3 introduces three scalable custom dataloaders: LaminDB, Census, and AnnCollection, enabling out-of-core and federated training without memory overload.\nCustom Dataloaders are only supported in SCVI & SCANVI models, but it should be easy to expand them to other models.\nThese backends support full compatibility with scvi\u2011tools data registration and training workflows, offering both scale and convenience to large projects."),(0,s.kt)("h3",{id:"lamindb"},"LaminDB"),(0,s.kt)("p",null,"Integrates with ",(0,s.kt)("a",{parentName:"p",href:"https://lamin.ai/"},"Lamindb"),", enabling out-of-core training from disk-backed collections. Users can register collections and seamlessly train models like SCVI using lamin's MappedCollection, benefiting from disk efficiency while maintaining full API compatibility with in-memory datasets. For more information see this ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/user_guide/use_case/custom_dataloaders.html"},"link"),"."),(0,s.kt)("p",null,"The next ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/use_cases/custom_dl/lamin.html"},"tutorial")," shows demonstration of a scalable approach to training an scVI model on PBMC data using Lamin dataloader."),(0,s.kt)("img",{alt:"lamin",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/lamin.png")}),(0,s.kt)("p",null,"Figure 6: SCVI Integration achieved using LaminDB dataloader, on 2 distinct PBMC data."),(0,s.kt)("p",null,"This ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/hub/Tahoe100_mrVI_lamin.html"},"tutorial")," shows the analysis of mrVI in its PyTorch version together with Lamin Custom dataloader over a subset of Tahoe100M cells dataset."),(0,s.kt)("img",{alt:"lamin",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/lamin_tahoe100.png")}),(0,s.kt)("p",null,"Figure 7: SCVI (bottom) & MRVI (top) Integration achieved using LaminDB dataloader, on a subset of Tahoe100M cells data."),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"census"},"Census"),(0,s.kt)("p",null,"employs ",(0,s.kt)("a",{parentName:"p",href:"https://www.tiledb.com/"},"TileDB-SOMA")," for atlas-scale tensor-backed data, offering similar streaming capabilities but enhanced support for multidimensional genomic inputs and federated study designs.\nThis custom dataloader directly read cellXgene dataset from S3 and train the SCVI model without the need to first download it, thus very suitable for few shots learning."),(0,s.kt)("p",null,"The next ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/use_cases/custom_dl/tiledb.html"},"tutorial")," shows demonstration of a scalable approach to training an scVI model on mus_musculus data using the Census dataloader"),(0,s.kt)("img",{alt:"census",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/census.png")}),(0,s.kt)("p",null,"Figure 8: SCVI Cell Integration achieved using Census dataloader, based on 4 type of batches: dataset_id, donor_id, assay and tissue_general"),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"anncollection"},"AnnCollection"),(0,s.kt)("p",null,"This dataloader allows training on multiple AnnData objects simultaneously, without merging them into one dataset. AnnCollection handles disparities in features or layers internally and aligns them during training, empowering federated or multi-study analyses"),(0,s.kt)("p",null,"The next ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/use_cases/custom_dl/ann_collection.html"},"tutorial")," shows how to apply the annCollection wrapper in scvi-tools to load and train SCANVI model on several adata's that are stored on disk.\nAnother ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/hub/Tahoe100.html"},"link")," shows how the ",(0,s.kt)("a",{parentName:"p",href:"https://doi.org/10.1101/2025.02.20.639398"},"Tahoe100M")," cells dataset was trained in SCVI using the annCollection wrapper and its minified version was stored on scvi-hub for further analysis."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"3-\ufe0f-core-enhancements"},"3. \u2699\ufe0f Core Enhancements"),(0,s.kt)("h3",{id:"multigpu-training"},"Multi\u2011GPU Training"),(0,s.kt)("p",null,"Built on PyTorch Lightning, v1.3 empowers all major models to run across multiple GPUs with a single API flag. Training benchmarks times reduced by number of GPU exists, with full gradient synchronization and no code modifications needed.\nSee the following ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/use_cases/multiGPU.html"},"tutorial")," and info ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/user_guide/use_case/multi_gpu_training.html"},"page")),(0,s.kt)("img",{alt:"multi-gpu",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/multigpu.png")}),(0,s.kt)("p",null,"Figure 9: comparison of SCVI training time between single and X2 multi-GPU machines as data increase. "),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"scibmetrics-optimization"},"scIB\u2011Metrics Optimization"),(0,s.kt)("p",null,"With the integration of ",(0,s.kt)("inlineCode",{parentName:"p"},"ScibCallback")," and the ",(0,s.kt)("inlineCode",{parentName:"p"},"AutotuneExperiment")," class, users can now monitor ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/YosefLab/scib-metrics"},"scIB metrics")," on the validation set during training and automatically tune hyperparameters (model, training and architecture parameters) based on these metrics\u2014directly optimizing for clustering and batch mixing performance, making the model training process more principled and outcome-driven.\nSee the following ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/use_cases/autotune_scvi.html#tuning-over-integration-metrics-with-scib-metrics"},"tutorial")),(0,s.kt)("hr",null),(0,s.kt)("h3",{id:"explainability--interpretability"},"Explainability & Interpretability"),(0,s.kt)("p",null,"v1.3 brings native support for ",(0,s.kt)("a",{parentName:"p",href:"https://captum.ai/api/integrated_gradients.html"},"Captum's")," Integrated Gradients (IG) across semi-supervised generative models like Scanvi and totalANVI. Users can compute marker-level attribution scores tied to latent dimensions or differential axes. This complements ",(0,s.kt)("inlineCode",{parentName:"p"},"get_normalized_expression"),", delivering a full pipeline that links model representations back to biologically interpretable molecular mechanisms, offering transparency and interpretability in deep generative modeling"),(0,s.kt)("p",null,"See the following ",(0,s.kt)("a",{parentName:"p",href:"https://docs.scvi-tools.org/en/stable/tutorials/notebooks/use_cases/interpretability.html"},"tutorial")," as an example of scanvi model ran on a PBMC dataset from 10X."),(0,s.kt)("img",{alt:"ig",width:"100%",src:(0,r.Z)("img/blog-post-scvi-tools-1p3/ig.png")}),(0,s.kt)("p",null,"Figure 10: Integrated gradients total contribution per gene per cell type, over data of PBMC."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"summary"},"Summary"),(0,s.kt)("p",null,"scvi\u2011tools v1.3 is a landmark release that advances the field across three foundational pillars:"),(0,s.kt)("ol",null,(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"Innovative modeling")," across ten tailored VAEs for spatial, protein, methylation, perturbation, and multi\u2011omic data.")),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"Scalable data processing")," with three new custom dataloaders in the backend, enabling efficient handling of federated, out-of-core, atlas-scale datasets, such as the Tahoe100M cells.")),(0,s.kt)("li",{parentName:"ol"},(0,s.kt)("p",{parentName:"li"},(0,s.kt)("strong",{parentName:"p"},"Infrastructure and transparency")," with multi-GPU training, metric-aware tuning, and demonstrable model interpretability."))),(0,s.kt)("p",null,"Together, these developments empower researchers to build, train, and interpret probabilistic models at scale-in a reproducible, transparent, and biologically meaningful way."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"references"},"References"),(0,s.kt)("div",{className:"footnotes"},(0,s.kt)("hr",{parentName:"div"}),(0,s.kt)("ol",{parentName:"div"},(0,s.kt)("li",{parentName:"ol",id:"fn-1"},"ResolVI: addressing noise and bias in spatial transcriptomics / Ergen et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")),(0,s.kt)("li",{parentName:"ol",id:"fn-2"},"scVIVA: a probabilistic framework for representation of cells and their environments in spatial transcriptomics / Levy et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-2",className:"footnote-backref"},"\u21a9")),(0,s.kt)("li",{parentName:"ol",id:"fn-3"},"CytoVI: Deep generative modeling of antibody-based single cell technologies / Ingelfinger et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-3",className:"footnote-backref"},"\u21a9")),(0,s.kt)("li",{parentName:"ol",id:"fn-4"},"VI-VS: calibrated identification of feature dependencies in single-cell multiomics / Boyeau et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-4",className:"footnote-backref"},"\u21a9")),(0,s.kt)("li",{parentName:"ol",id:"fn-5"},"sysVI: Integrating single-cell RNA-seq datasets with substantial batch effects / Hrovatin et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-5",className:"footnote-backref"},"\u21a9")),(0,s.kt)("li",{parentName:"ol",id:"fn-6"},"Decipher: Joint representation and visualization of derailed cell states with Decipher / Nazaret et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-6",className:"footnote-backref"},"\u21a9")),(0,s.kt)("li",{parentName:"ol",id:"fn-7"},"MethylVI: A deep generative model of single-cell methylomic data / Weinberger et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-7",className:"footnote-backref"},"\u21a9")),(0,s.kt)("li",{parentName:"ol",id:"fn-8"},"MrVI: Deep generative modeling of sample-level heterogeneity in single-cell genomics / Boyeau et al.",(0,s.kt)("a",{parentName:"li",href:"#fnref-8",className:"footnote-backref"},"\u21a9")))))}h.isMDXComponent=!0}}]);